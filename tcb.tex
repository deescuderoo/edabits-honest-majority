\usepackage{tcolorbox}
\tcbuselibrary{skins,breakable}

% Line to use as separator
\makeatletter
\newcommand{\DrawLine}{%
  \begin{tikzpicture}
  \path[use as bounding box] (0,0) -- (\linewidth,0);
  \draw[color=black!75,dashed,dash phase=2pt]
        (0-\kvtcb@leftlower-\kvtcb@boxsep,0)--
        (\linewidth+\kvtcb@rightlower+\kvtcb@boxsep,0);
  \end{tikzpicture}%
  }
\makeatother


%% Boxes
\newtcolorbox{mybox}[2][]{%
  enhanced,
  title        = {#2},
  attach boxed title to top left={xshift=+3mm,yshift*=-3mm},
  breakable    = true,
  colback      = black!4,
  colframe     = black!75,
  fonttitle    = \bfseries,
  colbacktitle = black!10!white,
  coltitle     = black,
  #1
}


\newtcolorbox[auto counter,list inside=func]{functionality}[2][]{%
  enhanced,
  title        = {Functionality~\thetcbcounter: #2},
  attach boxed title to top left={xshift=+3mm,yshift*=-3mm},
  breakable    = true,
  colback      = yellow!4,
  colframe     = black!75,
  fonttitle    = \bfseries,
  fontupper    = \small,
  fontlower    = \small,
  colbacktitle = yellow!10!white,
  coltitle     = black,
  #1
}

\newcounter{pro} % shared by protocols and procedures

\newtcolorbox[use counter=pro,list inside=prot]{protocol}[2][]{%
  enhanced,
  title        = {Protocol~\thetcbcounter: #2},
  attach boxed title to top left={xshift=+3mm,yshift*=-3mm},
  breakable    = true,
  colback      = black!4,
  colframe     = black!75,
  fonttitle    = \bfseries, 
  fontupper    = \small,
  fontlower    = \small,
  colbacktitle = black!10!white,
  coltitle     = black,
  #1
}

\newtcolorbox[use counter=pro,list inside=proc]{procedure}[2][]{%
  enhanced,
  title        = {Procedure~\thetcbcounter: #2},
  attach boxed title to top left={xshift=+3mm,yshift*=-3mm},
  breakable    = true,
  colback      = cyan!2,
  colframe     = black!75,
  fonttitle    = \bfseries, 
  fontupper    = \small,
  fontlower    = \small,
  colbacktitle = cyan!5!white,
  coltitle     = black,
  #1
}



\newtcbox{\xmybox}[1][red]{on line,
arc=7pt,colback=#1!10!white,colframe=#1!50!black,
before upper={\rule[-3pt]{0pt}{10pt}},boxrule=1pt,
boxsep=0pt,left=6pt,right=6pt,top=2pt,bottom=2pt}
